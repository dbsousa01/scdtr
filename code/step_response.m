clear; close all; clc;

values = [10.00;
10.00;
9.00;
10.00;
10.00;
10.00;
10.00;
10.00;
10.00;
10.00;
10.00;
10.00;
11.00;
10.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
11.00;
12.00;
11.00;
11.00;
11.00;
11.00;
10.00;
12.00;
11.00;
11.00;
11.00;
10.00;
11.00;
11.00;
12.00;
11.00;
12.00;
11.00;
11.00;
12.00;
12.00;
12.00;
11.00;
12.00;
12.00;
11.00;
9.00;
36.00;
88.00;
152.00;
221.00;
283.00;
336.00;
384.00;
425.00;
457.00;
481.00;
501.00;
521.00;
534.00;
544.00;
553.00;
562.00;
569.00;
573.00;
577.00;
582.00;
586.00;
587.00;
589.00;
594.00;
596.00;
595.00;
598.00;
602.00;
602.00;
601.00;
602.00;
606.00;
607.00;
605.00;
606.00;
609.00;
610.00;
608.00;
609.00;
612.00;
612.00;
611.00;
611.00;
614.00;
614.00;
613.00;
613.00;
615.00;
616.00;
614.00;
614.00;
616.00;
617.00;
615.00;
617.00;
618.00;
617.00;
617.00;
618.00;
618.00;
618.00;
617.00;
618.00;
620.00;
620.00;
618.00;
619.00;
620.00;
620.00;
619.00;
619.00;
621.00;
621.00;
619.00;
620.00;
622.00;
621.00;
620.00;
621.00;
623.00;
621.00;
620.00;
621.00;
622.00;
622.00;
621.00;
623.00;
623.00;
622.00;
622.00;
622.00;
623.00;
623.00;
623.00;
623.00;
624.00;
623.00;
622.00;
623.00;
624.00;
623.00;
622.00;
623.00;
625.00;
623.00;
623.00;
624.00;
624.00;
623.00;
623.00;
624.00;
625.00;
624.00;
623.00;
624.00;
625.00;
624.00;
624.00;
625.00;
625.00;
624.00;
623.00;
625.00;
626.00;
624.00;
624.00;
625.00;
626.00;
624.00;
624.00;
625.00;
626.00;
625.00;
624.00;
626.00;
626.00;
625.00;
624.00;
626.00;
626.00;
625.00;
625.00;
626.00;
626.00;
625.00;
625.00;
626.00;
626.00;
625.00;
625.00;
626.00;
626.00;
625.00;
625.00;
627.00;
628.00;
625.00;
625.00;
626.00;
626.00;
625.00;
625.00;
627.00;
628.00;
625.00;
625.00;
627.00;
627.00;
625.00;
625.00;
627.00;
627.00;
625.00;
625.00;
627.00;
627.00;
626.00;
625.00;
628.00;
628.00;
625.00;
625.00;
628.00;
628.00;
625.00;
625.00;
627.00;
628.00;
625.00;
625.00;
628.00;
628.00;
627.00;
626.00;
627.00;
628.00;
625.00;
625.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
625.00;
626.00;
628.00;
629.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
625.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
625.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
627.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
627.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
629.00;
626.00;
626.00;
628.00;
628.00;
627.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
627.00;
629.00;
628.00;
626.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
626.00;
628.00;
628.00;
626.00;
626.00;
628.00;
628.00;
627.00;
627.00;
629.00;
629.00;
626.00;
626.00;
628.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
628.00;
628.00;
628.00;
627.00;
627.00;
629.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
629.00;
627.00;
629.00;
628.00;
628.00;
627.00;
627.00;
628.00;
628.00;
627.00;
628.00;
629.00;
628.00;
627.00;
628.00;
629.00;
629.00;
627.00;
628.00;
628.00;
628.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
629.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
629.00;
628.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
629.00;
628.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
628.00;
627.00;
627.00;
629.00;
629.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
628.00;
629.00;
628.00;
627.00;
628.00;
628.00;
627.00;
627.00;
628.00;
629.00;
627.00;
627.00;
];

AR = values;

PWM = zeros(500,1);

R1 = 10;
m = -0.692;
b = 1.808;

f = R1*(5-((AR.*5)./(1023)))./((AR.*5)./(1023));
lux = 10.^((log10(f)-b)/m);

PWM(51:500) = 128;

t = linspace(0,1e6,length(PWM))';

figure
plot(t,PWM)
title('PWM step input')
figure
plot(t,AR)
title('Values from Arduino Analog Read')

figure
plot(t,lux)
title('Values LUX')
